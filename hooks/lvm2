# vim:set ft=sh:
run_hook ()
{
    mkdevice () { /bin/mknod "/dev/mapper/control" c ${1} ${2}; }

    if [ -e "/sys/class/misc/device-mapper" ]; then
        /bin/modprobe -q dm-mod >/dev/null 2>&1
        read dev_t < /sys/class/misc/device-mapper/dev
        OLDIFS=$IFS; IFS=:
        mkdevice $dev_t
        IFS=$OLDIFS

        msg "Scanning logical volumes..."
        /bin/lvm vgscan --ignorelockingfailure
        msg "Activating logical volumes..."
        /bin/lvm vgchange --ignorelockingfailure -ay
    fi
}
